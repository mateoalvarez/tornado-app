{% block head %}
  <link rel="stylesheet" href="{{ static_url("css/particles.css") }}" type="text/css">
  <link rel="stylesheet" href="{{ static_url("css/ml-models/ml-models.css") }}" type="text/css">
  <script src="{{ static_url("js/ml-models/ml-models.js") }}"></script>
<!-- javascript variables -->
  <script type="text/javascript">
    var deletePreprocessingButtonText = String('{{ _("models.application_creation.select.preprocessing.stage.delete_current") }}')
    // var preprocessingMethods = {{ str(data_prep_methods) }}
  </script>
{% end %}

<form method='post' action='/ml_models'>
  <div class="dropdown">
    <label for="application_dataset">{{ _("models.application_creation.select.dataset") }}</label>
    <select class="form-control" id="application_dataset" name="application_dataset">
      {% for dataset in datasets %}
        <option value="{{ dataset["id"] }}">{{ dataset["storage_url"] }}</option>
      {% end %}
    </select>
  </div>
  <hr />
  <div class="input-group">
    <label for="application_prep_stages_ids">{{ _("models.application_creation.select.preprocessing") }}</label>
    <br />
    <div class="container card-deck">
      <div class="container card-group my-3 px-0">
        <div class="card mx-0">
          <h4 class="card-header">{{ _("models.application_creation.select.preprocessing.stage.preprocessing") }} 1</h4>
          <div class="card-body">
            <select class="form-control" id="application_prepr_stages_ids" name="application_prepr_stages_ids">
              {% for method in data_prep_methods %}
                <option value="{{ method["id"] }}">{{ method["template_name"] }}</option>
              {% end %}
            </select>
          </div>
        </div>
        <div class="card mx-0">
          <h4 class="card-header">{{ _("models.application_creation.select.preprocessing.stage.config") }}</h4>
          <div class="card-body">
            <input class="text-input card-body w-100" id="application_prepr_stages_ids_0" name="application_prepr_stages_ids_config_0" />
          </div>
        </div>
      </div>
      <!-- Add more cards -->
      <div id="preprocessing-element-to-replace-0"> </div>

    </div>
    <button type="button" class="btn btn-primary" onclick="addNewPreprocessing()">{{ _("models.application_creation.select.preprocessing.stage.add_more") }}</button>
    <br />
  </div>
  <div class="input-group">
    <table>
      <tr>
        <th>
          method
        </th>
        <th>
          params
        </th>
      </tr>
      {% for method in data_prep_methods %}
        <tr>
          <td>
            <input type="checkbox" name="application_prep_stages_ids" value="{{ method["id"] }}">{{ method["template_name"] }}</input>
          </td>
          <td>
            <input class="text-input" id="{{ 'application_prep_stages_config_' + str(model["id"]) }}" name="{{ 'application_prep_stages_config_' + str(method["id"]) }}"></input>
          </td>
        </tr>
      {% end %}
    </table>
  </div>
  <hr />
  <div class="input-group">
    <label for="application_models_ids">{{ _("models.application_creation.select.model") }}</label>
    <br>
    <table>
      <tr>
        <th>
          model
        </th>
        <th>
          params
        </th>
      </tr>
      {% for model in models %}
        <tr>
          <td>
            <input type="checkbox" name="application_models_ids" value="{{ model["id"] }}">{{ model["template_name"] }}</input>
          </td>
          <td>
            <input class="text-input" id="{{ 'application_models_config_' + str(model["id"]) }}" name="{{ 'application_models_config_' + str(model["id"]) }}"></input>
          </td>
        </tr>
      {% end %}
    </table>
  </div>
  <hr />
  <div>
    <label for="classification_criteria">{{ _("models.application_creation.select.classification_criteria") }}</label>
    <select id="classification_criteria" name="classification_criteria">
      {% for criteria in classification_criteria %}
        <option value="{{ criteria["id"] }}">{{ criteria["name"] }}</option>
      {% end %}
    </select>
  </div>
  <hr />
  <div>
    <label for="application_name">{{ _("models.application_creation.select.pipeline_name") }}</label>
    <input class="text-input" id="application_name" name="application_name" type="text" value="" />
  </div>
  <hr />
  <div class="container">
    <button class="btn btn-primary" type='submit'>{{ _("models.application_creation.submit") }}</button>
  </div>
</form>

import unittest
import os
import json
from exploiter_core.exploiter_core.exploiter import ExploiterApplication

class ExploiterTests(unittest.TestCase):

    def test_get_none_kafka_consumer(self):
        my_test_exploiter = ExploiterApplication()
        consumer = my_test_exploiter.get_kafka_consumer()
        self.assertIsNone(consumer)

    def test_get_kafka_consumer(self):
        my_test_exploiter = ExploiterApplication()
        consumer = my_test_exploiter.get_kafka_consumer("MyTopic", "127.0.0.1")
        self.assertIsNotNone(consumer)

    def test_get_empty_data_preprocessed(self):
        data = None
        my_test_exploiter = ExploiterApplication()
        preprocessed_data = my_test_exploiter.get_data_preprocessed(data)
        self.assertIsNone(preprocessed_data)

    def test_get_data_preprocessed(self):
        data = {'filter_level': 'low', 'favorited': False, 'favorite_count': 0, 'reply_count': 0, 'in_reply_to_screen_name': None, 'coordinates': None, 'geo': None, 'retweeted': False, 'text': 'RT @LFCTransferNRS: Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL re…', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985484832368193538', 'created_at': 'Sun Apr 15 11:47:48 +0000 2018', 'retweet_count': 0, 'truncated': False, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'contributors': None, 'retweeted_status': {'extended_tweet': {'display_text_range': [0, 283], 'entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}], 'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': []}, 'full_text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL record for most goals by a player in a 38-game season. \n\nThe record is 31 goals, which is currently jointly held by Alan Shearer,\xa0Cristiano Ronaldo\xa0&amp;\xa0Luis Suarez. https://t.co/pKjgIFkDEw', 'extended_entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}]}}, 'favorited': False, 'favorite_count': 127, 'reply_count': 2, 'in_reply_to_screen_name': None, 'possibly_sensitive': False, 'coordinates': None, 'geo': None, 'retweet_count': 36, 'text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the P… https://t.co/UawFsqRBoF', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985412231109079041', 'filter_level': 'low', 'created_at': 'Sun Apr 15 06:59:18 +0000 2018', 'contributors': None, 'truncated': True, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'retweeted': False, 'user': {'profile_sidebar_fill_color': 'EFEFEF', 'protected': False, 'statuses_count': 49345, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/489229249/1523017202', 'followers_count': 76490, 'description': 'Independent Liverpool FC News • Transfers • Rumours • Stats • Opinions • #JFT96 Admin: @LFCMatt97 lfctransfernrs@gmail.com', 'profile_background_image_url_https': 'https://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_background_tile': True, 'default_profile_image': False, 'location': 'Liverpool', 'following': None, 'lang': 'en', 'friends_count': 495, 'profile_sidebar_border_color': 'FFFFFF', 'profile_background_color': '131516', 'id_str': '489229249', 'default_profile': False, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Sat Feb 11 09:40:17 +0000 2012', 'translator_type': 'regular', 'favourites_count': 3419, 'screen_name': 'LFCTransferNRS', 'contributors_enabled': False, 'id': 489229249, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_link_color': 'E90A0A', 'notifications': None, 'listed_count': 521, 'profile_image_url': 'http://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'name': 'LFC News', 'geo_enabled': True, 'url': 'http://facebook.com/LFCTransferNRS/', 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'display_text_range': [0, 140], 'entities': {'symbols': [], 'hashtags': [], 'urls': [{'indices': [117, 140], 'display_url': 'twitter.com/i/web/status/9…', 'url': 'https://t.co/UawFsqRBoF', 'expanded_url': 'https://twitter.com/i/web/status/985412231109079041'}], 'user_mentions': []}, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'id': 985412231109079041, 'quote_count': 2}, 'user': {'profile_sidebar_fill_color': 'DDEEF6', 'protected': False, 'statuses_count': 4082, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/282679880/1407507649', 'followers_count': 155, 'description': 'YNWA. love my baby girl Inaya....', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': False, 'default_profile_image': False, 'location': 'Barkingside, Essex', 'following': None, 'lang': 'en', 'friends_count': 255, 'profile_sidebar_border_color': 'C0DEED', 'profile_background_color': 'C0DEED', 'id_str': '282679880', 'default_profile': True, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Fri Apr 15 17:51:26 +0000 2011', 'translator_type': 'none', 'favourites_count': 1332, 'screen_name': 'mosanwar', 'contributors_enabled': False, 'id': 282679880, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_link_color': '1DA1F2', 'notifications': None, 'listed_count': 0, 'profile_image_url': 'http://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'name': 'Mos', 'geo_enabled': True, 'url': None, 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'timestamp_ms': '1523792868116', 'entities': {'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': [{'id_str': '489229249', 'indices': [3, 18], 'name': 'LFC News', 'screen_name': 'LFCTransferNRS', 'id': 489229249}]}, 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'id': 985484832368193538, 'quote_count': 0}
        my_test_exploiter = ExploiterApplication()
        preprocessed_data = my_test_exploiter.get_data_preprocessed(data)
        self.assertIsNotNone(preprocessed_data)

    def test_data_fake_processed(self):
        data = {'filter_level': 'low', 'favorited': False, 'favorite_count': 0, 'reply_count': 0, 'in_reply_to_screen_name': None, 'coordinates': None, 'geo': None, 'retweeted': False, 'text': 'RT @LFCTransferNRS: Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL re…', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985484832368193538', 'created_at': 'Sun Apr 15 11:47:48 +0000 2018', 'retweet_count': 0, 'truncated': False, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'contributors': None, 'retweeted_status': {'extended_tweet': {'display_text_range': [0, 283], 'entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}], 'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': []}, 'full_text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL record for most goals by a player in a 38-game season. \n\nThe record is 31 goals, which is currently jointly held by Alan Shearer,\xa0Cristiano Ronaldo\xa0&amp;\xa0Luis Suarez. https://t.co/pKjgIFkDEw', 'extended_entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}]}}, 'favorited': False, 'favorite_count': 127, 'reply_count': 2, 'in_reply_to_screen_name': None, 'possibly_sensitive': False, 'coordinates': None, 'geo': None, 'retweet_count': 36, 'text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the P… https://t.co/UawFsqRBoF', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985412231109079041', 'filter_level': 'low', 'created_at': 'Sun Apr 15 06:59:18 +0000 2018', 'contributors': None, 'truncated': True, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'retweeted': False, 'user': {'profile_sidebar_fill_color': 'EFEFEF', 'protected': False, 'statuses_count': 49345, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/489229249/1523017202', 'followers_count': 76490, 'description': 'Independent Liverpool FC News • Transfers • Rumours • Stats • Opinions • #JFT96 Admin: @LFCMatt97 lfctransfernrs@gmail.com', 'profile_background_image_url_https': 'https://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_background_tile': True, 'default_profile_image': False, 'location': 'Liverpool', 'following': None, 'lang': 'en', 'friends_count': 495, 'profile_sidebar_border_color': 'FFFFFF', 'profile_background_color': '131516', 'id_str': '489229249', 'default_profile': False, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Sat Feb 11 09:40:17 +0000 2012', 'translator_type': 'regular', 'favourites_count': 3419, 'screen_name': 'LFCTransferNRS', 'contributors_enabled': False, 'id': 489229249, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_link_color': 'E90A0A', 'notifications': None, 'listed_count': 521, 'profile_image_url': 'http://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'name': 'LFC News', 'geo_enabled': True, 'url': 'http://facebook.com/LFCTransferNRS/', 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'display_text_range': [0, 140], 'entities': {'symbols': [], 'hashtags': [], 'urls': [{'indices': [117, 140], 'display_url': 'twitter.com/i/web/status/9…', 'url': 'https://t.co/UawFsqRBoF', 'expanded_url': 'https://twitter.com/i/web/status/985412231109079041'}], 'user_mentions': []}, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'id': 985412231109079041, 'quote_count': 2}, 'user': {'profile_sidebar_fill_color': 'DDEEF6', 'protected': False, 'statuses_count': 4082, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/282679880/1407507649', 'followers_count': 155, 'description': 'YNWA. love my baby girl Inaya....', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': False, 'default_profile_image': False, 'location': 'Barkingside, Essex', 'following': None, 'lang': 'en', 'friends_count': 255, 'profile_sidebar_border_color': 'C0DEED', 'profile_background_color': 'C0DEED', 'id_str': '282679880', 'default_profile': True, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Fri Apr 15 17:51:26 +0000 2011', 'translator_type': 'none', 'favourites_count': 1332, 'screen_name': 'mosanwar', 'contributors_enabled': False, 'id': 282679880, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_link_color': '1DA1F2', 'notifications': None, 'listed_count': 0, 'profile_image_url': 'http://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'name': 'Mos', 'geo_enabled': True, 'url': None, 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'timestamp_ms': '1523792868116', 'entities': {'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': [{'id_str': '489229249', 'indices': [3, 18], 'name': 'LFC News', 'screen_name': 'LFCTransferNRS', 'id': 489229249}]}, 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'id': 985484832368193538, 'quote_count': 0}
        my_test_exploiter = ExploiterApplication()
        processed_data = my_test_exploiter.get_fake_classification(data)
        self.assertTrue("malaas_application_value" in processed_data)

    def test_store_data_in_mongo_empty_constructor(self):
        data = {'filter_level': 'low', 'favorited': False, 'favorite_count': 0, 'reply_count': 0, 'in_reply_to_screen_name': None, 'coordinates': None, 'geo': None, 'retweeted': False, 'text': 'RT @LFCTransferNRS: Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL re…', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985484832368193538', 'created_at': 'Sun Apr 15 11:47:48 +0000 2018', 'retweet_count': 0, 'truncated': False, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'contributors': None, 'retweeted_status': {'extended_tweet': {'display_text_range': [0, 283], 'entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}], 'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': []}, 'full_text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL record for most goals by a player in a 38-game season. \n\nThe record is 31 goals, which is currently jointly held by Alan Shearer,\xa0Cristiano Ronaldo\xa0&amp;\xa0Luis Suarez. https://t.co/pKjgIFkDEw', 'extended_entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}]}}, 'favorited': False, 'favorite_count': 127, 'reply_count': 2, 'in_reply_to_screen_name': None, 'possibly_sensitive': False, 'coordinates': None, 'geo': None, 'retweet_count': 36, 'text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the P… https://t.co/UawFsqRBoF', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985412231109079041', 'filter_level': 'low', 'created_at': 'Sun Apr 15 06:59:18 +0000 2018', 'contributors': None, 'truncated': True, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'retweeted': False, 'user': {'profile_sidebar_fill_color': 'EFEFEF', 'protected': False, 'statuses_count': 49345, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/489229249/1523017202', 'followers_count': 76490, 'description': 'Independent Liverpool FC News • Transfers • Rumours • Stats • Opinions • #JFT96 Admin: @LFCMatt97 lfctransfernrs@gmail.com', 'profile_background_image_url_https': 'https://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_background_tile': True, 'default_profile_image': False, 'location': 'Liverpool', 'following': None, 'lang': 'en', 'friends_count': 495, 'profile_sidebar_border_color': 'FFFFFF', 'profile_background_color': '131516', 'id_str': '489229249', 'default_profile': False, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Sat Feb 11 09:40:17 +0000 2012', 'translator_type': 'regular', 'favourites_count': 3419, 'screen_name': 'LFCTransferNRS', 'contributors_enabled': False, 'id': 489229249, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_link_color': 'E90A0A', 'notifications': None, 'listed_count': 521, 'profile_image_url': 'http://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'name': 'LFC News', 'geo_enabled': True, 'url': 'http://facebook.com/LFCTransferNRS/', 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'display_text_range': [0, 140], 'entities': {'symbols': [], 'hashtags': [], 'urls': [{'indices': [117, 140], 'display_url': 'twitter.com/i/web/status/9…', 'url': 'https://t.co/UawFsqRBoF', 'expanded_url': 'https://twitter.com/i/web/status/985412231109079041'}], 'user_mentions': []}, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'id': 985412231109079041, 'quote_count': 2}, 'user': {'profile_sidebar_fill_color': 'DDEEF6', 'protected': False, 'statuses_count': 4082, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/282679880/1407507649', 'followers_count': 155, 'description': 'YNWA. love my baby girl Inaya....', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': False, 'default_profile_image': False, 'location': 'Barkingside, Essex', 'following': None, 'lang': 'en', 'friends_count': 255, 'profile_sidebar_border_color': 'C0DEED', 'profile_background_color': 'C0DEED', 'id_str': '282679880', 'default_profile': True, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Fri Apr 15 17:51:26 +0000 2011', 'translator_type': 'none', 'favourites_count': 1332, 'screen_name': 'mosanwar', 'contributors_enabled': False, 'id': 282679880, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_link_color': '1DA1F2', 'notifications': None, 'listed_count': 0, 'profile_image_url': 'http://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'name': 'Mos', 'geo_enabled': True, 'url': None, 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'timestamp_ms': '1523792868116', 'entities': {'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': [{'id_str': '489229249', 'indices': [3, 18], 'name': 'LFC News', 'screen_name': 'LFCTransferNRS', 'id': 489229249}]}, 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'id': 985484832368193538, 'quote_count': 0}
        my_test_exploiter = ExploiterApplication()
        processed_data = my_test_exploiter.get_fake_classification(data)
        self.assertFalse(my_test_exploiter.store_in_mongo(processed_data))

    def test_store_data_in_mongo(self):
        data = {'filter_level': 'low', 'favorited': False, 'favorite_count': 0, 'reply_count': 0, 'in_reply_to_screen_name': None, 'coordinates': None, 'geo': None, 'retweeted': False, 'text': 'RT @LFCTransferNRS: Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL re…', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985484832368193538', 'created_at': 'Sun Apr 15 11:47:48 +0000 2018', 'retweet_count': 0, 'truncated': False, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'contributors': None, 'retweeted_status': {'extended_tweet': {'display_text_range': [0, 283], 'entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}], 'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': []}, 'full_text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the PL record for most goals by a player in a 38-game season. \n\nThe record is 31 goals, which is currently jointly held by Alan Shearer,\xa0Cristiano Ronaldo\xa0&amp;\xa0Luis Suarez. https://t.co/pKjgIFkDEw', 'extended_entities': {'media': [{'sizes': {'large': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'small': {'w': 680, 'h': 458, 'resize': 'fit'}, 'medium': {'w': 1024, 'h': 690, 'resize': 'fit'}, 'thumb': {'w': 150, 'h': 150, 'resize': 'crop'}}, 'expanded_url': 'https://twitter.com/LFCTransferNRS/status/985412231109079041/photo/1', 'media_url_https': 'https://pbs.twimg.com/media/DazjLfMVQAArOel.jpg', 'indices': [284, 307], 'type': 'photo', 'display_url': 'pic.twitter.com/pKjgIFkDEw', 'id_str': '985412204978585600', 'id': 985412204978585600, 'url': 'https://t.co/pKjgIFkDEw', 'media_url': 'http://pbs.twimg.com/media/DazjLfMVQAArOel.jpg'}]}}, 'favorited': False, 'favorite_count': 127, 'reply_count': 2, 'in_reply_to_screen_name': None, 'possibly_sensitive': False, 'coordinates': None, 'geo': None, 'retweet_count': 36, 'text': 'Mo Salah has now scored 30 PL goals so far this season!\n\nHe needs two more goals in our last 4 games to break the P… https://t.co/UawFsqRBoF', 'in_reply_to_user_id_str': None, 'place': None, 'lang': 'en', 'is_quote_status': False, 'id_str': '985412231109079041', 'filter_level': 'low', 'created_at': 'Sun Apr 15 06:59:18 +0000 2018', 'contributors': None, 'truncated': True, 'in_reply_to_status_id': None, 'in_reply_to_user_id': None, 'retweeted': False, 'user': {'profile_sidebar_fill_color': 'EFEFEF', 'protected': False, 'statuses_count': 49345, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/489229249/1523017202', 'followers_count': 76490, 'description': 'Independent Liverpool FC News • Transfers • Rumours • Stats • Opinions • #JFT96 Admin: @LFCMatt97 lfctransfernrs@gmail.com', 'profile_background_image_url_https': 'https://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_background_tile': True, 'default_profile_image': False, 'location': 'Liverpool', 'following': None, 'lang': 'en', 'friends_count': 495, 'profile_sidebar_border_color': 'FFFFFF', 'profile_background_color': '131516', 'id_str': '489229249', 'default_profile': False, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Sat Feb 11 09:40:17 +0000 2012', 'translator_type': 'regular', 'favourites_count': 3419, 'screen_name': 'LFCTransferNRS', 'contributors_enabled': False, 'id': 489229249, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://pbs.twimg.com/profile_background_images/454219506244538369/VtKm_LUY.jpeg', 'profile_link_color': 'E90A0A', 'notifications': None, 'listed_count': 521, 'profile_image_url': 'http://pbs.twimg.com/profile_images/780342412866486276/dxzkQqJT_normal.jpg', 'name': 'LFC News', 'geo_enabled': True, 'url': 'http://facebook.com/LFCTransferNRS/', 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'display_text_range': [0, 140], 'entities': {'symbols': [], 'hashtags': [], 'urls': [{'indices': [117, 140], 'display_url': 'twitter.com/i/web/status/9…', 'url': 'https://t.co/UawFsqRBoF', 'expanded_url': 'https://twitter.com/i/web/status/985412231109079041'}], 'user_mentions': []}, 'source': '<a href="http://twitter.com/download/android" rel="nofollow">Twitter for Android</a>', 'id': 985412231109079041, 'quote_count': 2}, 'user': {'profile_sidebar_fill_color': 'DDEEF6', 'protected': False, 'statuses_count': 4082, 'verified': False, 'profile_banner_url': 'https://pbs.twimg.com/profile_banners/282679880/1407507649', 'followers_count': 155, 'description': 'YNWA. love my baby girl Inaya....', 'profile_background_image_url_https': 'https://abs.twimg.com/images/themes/theme1/bg.png', 'profile_background_tile': False, 'default_profile_image': False, 'location': 'Barkingside, Essex', 'following': None, 'lang': 'en', 'friends_count': 255, 'profile_sidebar_border_color': 'C0DEED', 'profile_background_color': 'C0DEED', 'id_str': '282679880', 'default_profile': True, 'profile_use_background_image': True, 'profile_text_color': '333333', 'created_at': 'Fri Apr 15 17:51:26 +0000 2011', 'translator_type': 'none', 'favourites_count': 1332, 'screen_name': 'mosanwar', 'contributors_enabled': False, 'id': 282679880, 'follow_request_sent': None, 'time_zone': 'London', 'profile_image_url_https': 'https://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'is_translator': False, 'profile_background_image_url': 'http://abs.twimg.com/images/themes/theme1/bg.png', 'profile_link_color': '1DA1F2', 'notifications': None, 'listed_count': 0, 'profile_image_url': 'http://pbs.twimg.com/profile_images/654222160647598080/9W-L6GUQ_normal.jpg', 'name': 'Mos', 'geo_enabled': True, 'url': None, 'utc_offset': 3600}, 'in_reply_to_status_id_str': None, 'timestamp_ms': '1523792868116', 'entities': {'symbols': [], 'hashtags': [], 'urls': [], 'user_mentions': [{'id_str': '489229249', 'indices': [3, 18], 'name': 'LFC News', 'screen_name': 'LFCTransferNRS', 'id': 489229249}]}, 'source': '<a href="http://twitter.com/download/iphone" rel="nofollow">Twitter for iPhone</a>', 'id': 985484832368193538, 'quote_count': 0}
        my_test_exploiter = ExploiterApplication("192.168.240.3", 27017, "malaas_tested_db", "malaas_tested_collection")
        processed_data = my_test_exploiter.get_fake_classification(data)
        self.assertTrue(my_test_exploiter.store_in_mongo(processed_data))

def main():
    unittest.main()

if __name__ == '__main__':
    main()